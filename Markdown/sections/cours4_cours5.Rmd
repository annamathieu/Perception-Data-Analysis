---
title: "cours4_cours5"
author: "M2 Stat optional class Analyse de données de Perception"
date: "2025-11-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Tâches de tri

Les **tâches de tri** consistent à donner à des juges un **ensemble d'objets ou d'assertions** et à leur demander de les **regrouper** en catégories. Les données obtenues sont qualitative. 

- On ne donne **pas de prisme au juge** (ni critères, ni liste de groupes prédéfinis)

- On cherche à **comprendre la grille de lecture de la personne**, c'est-à-dire la façon dont elle perçoit les similitudes et différences entre les stimuli. 

- On peut ensuite demander au juge de **caractériser** chaque groupe (nommer le groupe)

Ce type de tâche s'intéresse directement au processus cognitif mis en jeu pour organiser l'information. 

__exemple : 12 stimuli et 55 individus__
Supposons que l'on dispose de 12 stimuli et de 55 individus. Quelle forme peut prendre le tableau de données ? 

- Tableau 55 x 12 : chaque individu est décrit par sa manière de trier ou de catégoriser les 12 stimuli. 

- Tableau 12 x 55 : Chaque colonne représente alors un système de tri proposé par un individu (un « set de stimuli » organisé par cette personne). Ce tableau permet de **calculer des distances entre stimuli**, en fonction de la fréquence avec laquelle ils sont mis ensemble par les différents juges. À l’intersection, on peut rattacher les **labels ou commentaires** associés aux groupes par les juges : ces commentaires fournissent des critères d’interprétation des dimensions qui ressortiront des analyses (par exemple, « sucré », « chimique », « métallique », etc.).

A partir de ces tableaux plusieurs types d'analyses sont envisageables. Sur un tableau 12 × 55, on peut réaliser une **Analyse des Correspondances Multiples (ACM)**. L’objectif est d’explorer la structure des relations entre stimuli et individus, et de représenter l’espace perceptif.

En agrégeant les informations de tri, on peut construire un tableau 12 × 12 de co-occurrences. Chaque case indique le nombre de fois où deux objets ont été mis ensemble par les juges.On peut alors effectuer une Analyse des Correspondances (AC) sur ce tableau. Ce type d’analyse se rattache au principe de l’unfolding, où l’on cherche à représenter la proximité entre objets en fonction des co-choix des individus.
Cependant, il existe des limites à ce tableau puisqu'on perd l’information des commentaires, il faut alors les ajouter comme éléments supplémentaires. On perd de la variabilité individuelle, car on a agrégé l’ensemble des tris, les différences entre juges ne sont plus visibles.

## Tri séquentiel aglomératif

### Saturation 
Pour des concepts, trier 12, 25 ou 40 concepts reste relativement gérable pour le juge. En revanche, pour les odeurs, trier 12, 25 ou 40 stimulis olfactifs entraîne **rapidement une saturation** (factigue sensorielle et difficulté à maintenir une comparaison fine entre tous les stimulis). 

C'est ici qu'intervient la planification expérimentale : il devient nécessaire d'utiliser des plans incomplets, car on ne peut pas demander au juge de comparer toutes les odeurs en une seule fois. 

Cependant, l'utilisation de ces plans fait perdre de l'information. Les distances entre stimuli ne sont plus exactement les mêmes que si tous les stimuli avaient été vus ensemble. Cela peut modifier la structure perceptive que l’on observe (on parle de problème de focale, l’espace perceptif dépend du sous-ensemble présenté).

**Les stimuli forment un tout**. La perception d’un stimulus dépend aussi du contexte, c’est-à-dire des autres stimuli présentés avec lui. En fragmentant ce tout, on risque d’altérer la représentation globale.

Il faut donc pallier ce problème de distance. Si l’on décide de **faire plusieurs sessions**, il devient nécessaire de réduire le nombre de comparaisons à effectuer à chaque session, tout en gardant une structure cohérente.

### Principe du tri séquentiel aglomératif

#### Etape 1 : passer des individus aux groupes. 

Lors d’une première session, chaque juge doit trier un nombre limité d’odeurs (par exemple 10 odeurs). Ils forment des groupes à partir de ce sous-ensemble. Cette étape permet de passer des réponses individuelles à des groupes structurants (des pôles perceptifs).

#### Etape 2 : associer les nouveaux stimuli aux groupes. 

Dans les sessions suivantes, les nouveaux stimuli sont associés aux groupes existants, qui jouent le rôle de pôles ou points d’ancrage.

Les juges peuvent :

- attribuer un nouveau stimulus à un groupe existant,

- modifier un groupe si besoin,

- ou créer un nouveau groupe si le stimulus ne correspond à aucun pôle existant.

L'intérêt est qu'on réduit le nombre de distances à estimer. On ne compare plus chaque stimulus avec tous les autres, mais on l’associe à un groupe. On **freine l’espace de perception**. L’espace perceptif est structuré autour de quelques pôles stables, les nouveaux stimuli viennent s’ancrer dans cet espace au lieu de redéfinir entièrement la carte perceptive à chaque fois.

## Tri divisif

Dans cette tâche de tri, on va s'intéresser au sujets, qui vont trier nos objets, mais on va surtout s'intéresser au processus cognitif de ces sujets. 

### Principe du tri
Cette fois ci, notre exemple sera le tri de différentes carte par des enfants. Les enfants auront devant eux 16 cartes représentant un graphisme simple, comprenant 7 informations à 2 modalités :
- La couleur du fond de carte (rouge / jaune)
- Le style du fond de carte (uni / dégradé)
- La forme affichée (carré / triangle)
- La position de la forme (haut / bas)
- La couleur de la forme (bleu / vert)
- La taille de la forme (grand petit)
- Le type de contour de la forme (trait plein / trait pointillé)


On demande aux enfants de créer deux groupes distinct à partir du premier groupe (toutes les cartes). Puis autant de fois qu'ils le veulent, ils peuvent diviser à nouveau ces différents groupes en différents groupes. On obtient alors une suite de partitions emboitées, une hiérarchie entre ces partitions. C'est un processus de tri divisif. Grâce à cela, on peut extraire la première feature, le critère de division le plus fréquent chez les sujets. En observant ensuite les chemins de pensées, on peut s'intéresser aux réflexions atypiques, pour mieux comprendre les processus cognitif chez ces enfants.

### Principe d'analyse des chemins de pensées

Pour pouvoir représenter les choses, on voudrait avoir un plan factoriel qui sépare les 16 cartes d'abord en fonction du critère de séparation le plus utilisé (1er axe du plan factoriel), puis en fonction du second (2e axe du plan factoriel). 
Intéressons nous ici à un enfant. En ACM, une des représentations des variables est le carré des liaisons, où chaque variable est représentée en fonction l'importance de sa liaison avec le premier axe et le second axe du plan factoriel. On aimerait donc avoir en variable les différentes étapes du tri pour cet enfant. On pourrait alors observer quel étape est corrélée avec le premier axe, puis quelle seconde division est corrélée au premier et second axe... On aurait alors une représentation du chemin de pensée de cet enfant. Mais puisque l'on a plusieurs enfants différents, une ACM de suffit pas. On accorderait autant d'importance à chaque enfant, et l'on veut traiter ces variables comme appartenant à différents groupes (un par enfant). On peut donc se dire que l'ACM est en réalité une AFM dont chaque groupe est constitué d'une seule variable, puis on induit une hiérarchie grâce à une AFMH en ajoutant un groupe par enfant.   

On a donc nos données sous la forme du tableau suivant :
- 16 lignes correspondant aux 16 cartes 
- 430 variables correspondant chacune à une des partitions d'un des enfants (par exemple : Enfant 13, étage 2 de sa hiérarchie)

### Analyse des différentes tâches de tri

On va commencer par analyser les tâches de tri en elles-mêmes. Pour avoir une idée de l'évolution du chemin de pensée selon différentes information. Le tableau contient donc en ligne tous les enfants, et en colonne des informations sur eux ou sur le déroulement de la tâche de tri.

```{r}
library(readxl)
library(FactoMineR)
donnees <- read_xls("Markdown/dataset/Descriptive.xls")
summary(donnees)
donnees_1 <- donnees[,c(4,5,6,7,9,11)]

res.PCA<- PCA(donnees_1, quali.sup=c(6), graph = F)
plot.PCA(res.PCA, choix = "var")
```

On voit sur le graphe des variables que les des variables que le plan factoriel est très corrélé aux variables suivantes : Nombre de critère cité, utilisés, nombre de hiérarchie et nombre de classes finales sont très liées à la première dimension. Le temps passé avec l'enfant est lui très lié à la seconde dimension. On suppose que le processus de réflexion de l'enfant est très lié à la complexité du tri final, et au temps passé à sur cette tâche.

```{r}
plot.PCA(res.PCA, invisible="ind")
```

On remarque ici très nettement une évolution de la réflexion en fonction de l'âge de l'enfant. Il est donc très intéressant de voir les chemins de pensée associés à cette représentation

### Analyse des processus cognitif

On récupère donc le tableau de données comportant les partitions 

```{r}
library(tidyverse)
### On veut réaliser le graphique avec les chemins de pensées.

Tri <- read.table("Markdown/dataset/trih.txt", header = TRUE, stringsAsFactors = TRUE)

Tri <- Tri %>% mutate(across(everything(), as.factor))
print(Tri[,1:9])

```

Pour réaliser l'AFMH, on doit définir la hiérarchie au travers des variable. Ici, dès qu'il y a un "H1" dans le nom d'une des variables, 

```{r}

# Exemple de vecteur
x <- names(Tri[-1])

# Étape 1 : compter le nombre de "H1"
n <- sum(grepl("H1", x))
cat("Nombre de 'H1' :", n, "\n")

# Étape 2 : trouver les positions de chaque "H1"
pos <- which(grepl("H1", x))

# Étape 3 : calculer le nombre d’éléments avant le prochain "H1"
# Pour chaque "H1", on regarde la distance jusqu’au suivant
res <- integer(n)
for (i in seq_len(n)) {
  if (i < n) {
    res[i] <- pos[i + 1] - pos[i]
  } else {
    res[i] <- length(x) - pos[i] + 1 # jusqu’à la fin du vecteur
  }
}


res
res2 <- rep(1, ncol(Tri)-1)


```


```{r}

res.AFMH <- HMFA(Tri[-1],
                 H = list(res2, res), 
                 type = rep("n", times = length(res2)),
                 graph = FALSE)




head(res_MFT_HMFA$ind$coord)
```


















